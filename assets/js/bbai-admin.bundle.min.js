/**
* Admin Bundle
* Auto-generated from modular source files
* DO NOT EDIT DIRECTLY - Edit source files in assets/src/js/admin/
*
* @package BeepBeep_AI
* @since 5.0.0
* @generated 2026-01-08T08:57:05.456Z
*/
/* ============================================
* config.js
* ============================================ */
/**
* Admin Configuration
* Configuration and utility functions for admin operations
*
* @package BeepBeep_AI
* @since 5.0.0
*/
(function($) {
'use strict';
window.bbaiAdminConfig = window.BBAI_DASH || window.BBAI || {};
window.bbaiHasBulkConfig = !!(window.bbaiAdminConfig.rest && window.bbaiAdminConfig.nonce);
if (!window.bbaiHasBulkConfig) {
console.warn('[AI Alt Text] REST configuration missing. Bulk operations disabled, but single regenerate will still work.');
}
/**
* Check if current user can manage account
*/
window.bbaiCanManageAccount = function() {
return !!(window.BBAI && window.BBAI.canManage);
};
/**
* Handle limit reached - show upgrade modal
*/
window.bbaiHandleLimitReached = function(errorData) {
var message = (errorData && errorData.message) || 'Monthly limit reached. Please contact a site administrator.';
if (!window.bbaiCanManageAccount()) {
if (typeof showNotification === 'function') {
showNotification(message, 'warning');
}
return;
}
var usage = errorData && errorData.usage ? errorData.usage : null;
if (typeof alttextaiShowModal === 'function') {
alttextaiShowModal();
} else if (typeof window.alttextaiShowModal === 'function') {
window.alttextaiShowModal();
} else if (typeof showUpgradeModal === 'function') {
showUpgradeModal(usage);
} else if (typeof window.beepbeepai_show_upgrade_modal === 'function') {
window.beepbeepai_show_upgrade_modal(usage);
} else {
var upgradeBtn = document.querySelector('[data-action="show-upgrade-modal"]');
if (upgradeBtn) {
upgradeBtn.click();
} else {
$(document).trigger('alttextai:show-upgrade-modal', [usage]);
}
}
if (typeof showNotification === 'function') {
showNotification(message, 'error');
}
};
/**
* Escape HTML to prevent XSS
*/
window.bbaiEscapeHtml = function(text) {
var div = document.createElement('div');
div.textContent = text;
return div.innerHTML;
};
/**
* Show notification message
*/
window.bbaiShowNotification = function(message, type) {
type = type || 'info';
var $notice = $('<div class="notice notice-' + type + ' is-dismissible"><p>' + message + '</p></div>');
$('.wrap').first().prepend($notice);
setTimeout(function() {
$notice.fadeOut(function() {
$notice.remove();
});
}, 5000);
};
window.showNotification = window.bbaiShowNotification;
})(jQuery);
/* ============================================
* queue.js
* ============================================ */
/**
* Queue Management
* Handles image queue operations for bulk processing
*
* @package BeepBeep_AI
* @since 5.0.0
*/
(function($) {
'use strict';
var config = window.bbaiAdminConfig || {};
/**
* Queue multiple images for processing
* Uses AJAX endpoint to queue images without generating immediately
*/
window.bbaiQueueImages = function(ids, source, callback) {
if (!ids || ids.length === 0) {
callback(false, 0);
return;
}
var ajaxUrl = '/wp-admin/admin-ajax.php';
if (window.bbai_ajax) {
ajaxUrl = window.bbai_ajax.ajax_url || window.bbai_ajax.ajaxurl || ajaxUrl;
} else if (typeof ajaxurl !== 'undefined') {
ajaxUrl = ajaxurl;
}
var nonceValue = (window.bbai_ajax && window.bbai_ajax.nonce) || config.nonce;
$.ajax({
url: ajaxUrl,
method: 'POST',
data: {
action: 'beepbeepai_bulk_queue',
attachment_ids: ids,
source: source || 'bulk',
nonce: nonceValue
},
dataType: 'json'
})
.done(function(response) {
if (response && response.success) {
var responseData = response.data || {};
var queued = responseData.queued || 0;
if (queued > 0) {
callback(true, queued, null, ids.slice(0));
} else {
console.warn('[AI Alt Text] No images were queued. Response:', response);
callback(true, queued, null, ids.slice(0));
}
} else {
var errorMessage = 'Failed to queue images';
var errorCode = null;
var errorRemaining = null;
if (response && response.data) {
if (typeof response.data === 'object' && response.data !== null) {
if (response.data.message) {
errorMessage = response.data.message;
}
if (response.data.code) {
errorCode = response.data.code;
}
if (response.data.remaining !== undefined && response.data.remaining !== null) {
errorRemaining = parseInt(response.data.remaining, 10);
}
}
}
console.error('[AI Alt Text] Queue failed:', errorMessage, errorCode ? '(Code: ' + errorCode + ')' : '');
callback(false, 0, {
message: errorMessage,
code: errorCode,
remaining: errorRemaining
}, ids.slice(0));
}
})
.fail(function(xhr, status, error) {
console.error('[AI Alt Text] AJAX request failed:', {
status: status,
error: error,
xhr: xhr,
responseText: xhr.responseText,
statusCode: xhr.status
});
var errorData = null;
try {
var parsed = JSON.parse(xhr.responseText);
if (parsed && parsed.data) {
errorData = {
message: parsed.data.message || 'Failed to queue images',
code: parsed.data.code || null,
remaining: parsed.data.remaining || null
};
}
} catch (e) {
}
if (xhr.status === 403) {
console.error('[AI Alt Text] Authentication error - check nonce');
callback(false, 0, errorData || { message: 'Authentication error. Please refresh the page and try again.' });
return;
}
if (errorData && errorData.message) {
callback(false, 0, errorData);
return;
}
bbaiQueueImagesFallback(ids, source, function(success, queued) {
callback(success, queued, null, ids.slice(0));
});
});
};
/**
* Fallback: Queue images one by one via REST API
*/
function bbaiQueueImagesFallback(ids, source, callback) {
var total = ids.length;
var queued = 0;
var failed = 0;
var batchSize = 5;
var processed = 0;
function processBatch(startIndex) {
var endIndex = Math.min(startIndex + batchSize, total);
var batch = ids.slice(startIndex, endIndex);
var promises = batch.map(function(id) {
return $.ajax({
url: (config.restRoot || config.rest || '') + 'bbai/v1/generate/' + id,
method: 'POST',
headers: {
'X-WP-Nonce': config.nonce
}
})
.done(function() {
queued++;
processed++;
if (typeof updateBulkProgress === 'function') {
updateBulkProgress(processed, total);
}
})
.fail(function() {
failed++;
processed++;
if (typeof updateBulkProgress === 'function') {
updateBulkProgress(processed, total);
}
});
});
$.when.apply($, promises)
.then(function() {
if (endIndex < total) {
setTimeout(function() {
processBatch(endIndex);
}, 500);
} else {
var success = queued > 0;
callback(success, queued, null);
}
})
.fail(function() {
console.error('[AI Alt Text] Fallback batch failed');
if (endIndex < total) {
setTimeout(function() {
processBatch(endIndex);
}, 500);
} else {
var success = queued > 0;
callback(success, queued, null);
}
});
}
processBatch(0);
}
window.queueImages = window.bbaiQueueImages;
})(jQuery);
/* ============================================
* progress-modal.js
* ============================================ */
/**
* Progress Modal
* Bulk progress modal for tracking generation status
*
* @package BeepBeep_AI
* @since 5.0.0
*/
(function($) {
'use strict';
/**
* Show bulk progress modal with detailed tracking
*/
window.showBulkProgress = function(label, total, current) {
var $modal = $('#bbai-bulk-progress-modal');
if (!$modal.length) {
$modal = createBulkProgressModal();
}
$modal.data('startTime', Date.now());
$modal.data('total', total);
$modal.data('current', current || 0);
$modal.find('.bbai-bulk-progress__title').text(label || 'Processing Images...');
$modal.find('.bbai-bulk-progress__total').text(total);
$modal.find('.bbai-bulk-progress__log').empty();
$modal.addClass('active');
$('body').css('overflow', 'hidden');
updateBulkProgress(current || 0, total);
};
/**
* Create bulk progress modal HTML
*/
function createBulkProgressModal() {
var modalHtml =
'<div id="bbai-bulk-progress-modal" class="bbai-bulk-progress-modal">' +
'    <div class="bbai-bulk-progress-modal__overlay"></div>' +
'    <div class="bbai-bulk-progress-modal__content">' +
'        <div class="bbai-bulk-progress__header">' +
'            <h2 class="bbai-bulk-progress__title">Processing Images...</h2>' +
'            <button type="button" class="bbai-bulk-progress__close" aria-label="Close">×</button>' +
'        </div>' +
'        <div class="bbai-bulk-progress__body">' +
'            <div class="bbai-bulk-progress__stats">' +
'                <div class="bbai-bulk-progress__stat">' +
'                    <span class="bbai-bulk-progress__stat-label">Progress</span>' +
'                    <span class="bbai-bulk-progress__stat-value">' +
'                        <span class="bbai-bulk-progress__current">0</span> / ' +
'                        <span class="bbai-bulk-progress__total">0</span>' +
'                    </span>' +
'                </div>' +
'                <div class="bbai-bulk-progress__stat">' +
'                    <span class="bbai-bulk-progress__stat-label">Percentage</span>' +
'                    <span class="bbai-bulk-progress__stat-value bbai-bulk-progress__percentage">0%</span>' +
'                </div>' +
'                <div class="bbai-bulk-progress__stat">' +
'                    <span class="bbai-bulk-progress__stat-label">Estimated Time</span>' +
'                    <span class="bbai-bulk-progress__stat-value bbai-bulk-progress__eta">Calculating...</span>' +
'                </div>' +
'            </div>' +
'            <div class="bbai-bulk-progress__bar-container">' +
'                <div class="bbai-bulk-progress__bar">' +
'                    <div class="bbai-bulk-progress__bar-fill" style="width: 0%"></div>' +
'                </div>' +
'            </div>' +
'            <div class="bbai-bulk-progress__log-container">' +
'                <h3 class="bbai-bulk-progress__log-title">Processing Log</h3>' +
'                <div class="bbai-bulk-progress__log"></div>' +
'            </div>' +
'        </div>' +
'    </div>' +
'</div>';
$('body').append(modalHtml);
var $modal = $('#bbai-bulk-progress-modal');
$modal.find('.bbai-bulk-progress__close').on('click', function() {
hideBulkProgress();
});
return $modal;
}
/**
* Update bulk progress bar with detailed stats
*/
window.updateBulkProgress = function(current, total, imageTitle) {
var $modal = $('#bbai-bulk-progress-modal');
if (!$modal.length) return;
var percentage = total > 0 ? Math.round((current / total) * 100) : 0;
var startTime = $modal.data('startTime') || Date.now();
var elapsed = (Date.now() - startTime) / 1000;
var eta = 'Calculating...';
if (current > 0 && elapsed > 0) {
var avgTimePerImage = elapsed / current;
var remaining = total - current;
var etaSeconds = remaining * avgTimePerImage;
if (etaSeconds < 60) {
eta = Math.ceil(etaSeconds) + 's';
} else if (etaSeconds < 3600) {
eta = Math.ceil(etaSeconds / 60) + 'm';
} else {
var hours = Math.floor(etaSeconds / 3600);
var mins = Math.ceil((etaSeconds % 3600) / 60);
eta = hours + 'h ' + mins + 'm';
}
}
$modal.find('.bbai-bulk-progress__current').text(current);
$modal.find('.bbai-bulk-progress__percentage').text(percentage + '%');
$modal.find('.bbai-bulk-progress__eta').text(eta);
$modal.find('.bbai-bulk-progress__bar-fill').css('width', percentage + '%');
if (imageTitle) {
var timestamp = new Date().toLocaleTimeString();
var escapeHtml = window.bbaiEscapeHtml || function(t) { return t; };
var logEntry =
'<div class="bbai-bulk-progress__log-entry">' +
'    <span class="bbai-bulk-progress__log-time">' + timestamp + '</span>' +
'    <span class="bbai-bulk-progress__log-icon">✓</span>' +
'    <span class="bbai-bulk-progress__log-text">' + escapeHtml(imageTitle) + '</span>' +
'</div>';
var $log = $modal.find('.bbai-bulk-progress__log');
$log.append(logEntry);
$log.scrollTop($log[0].scrollHeight);
}
};
/**
* Add error log entry
*/
window.logBulkProgressError = function(errorMessage) {
var $modal = $('#bbai-bulk-progress-modal');
if (!$modal.length) return;
var timestamp = new Date().toLocaleTimeString();
var escapeHtml = window.bbaiEscapeHtml || function(t) { return t; };
var logEntry =
'<div class="bbai-bulk-progress__log-entry bbai-bulk-progress__log-entry--error">' +
'    <span class="bbai-bulk-progress__log-time">' + timestamp + '</span>' +
'    <span class="bbai-bulk-progress__log-icon">✗</span>' +
'    <span class="bbai-bulk-progress__log-text">' + escapeHtml(errorMessage || 'An error occurred') + '</span>' +
'</div>';
var $log = $modal.find('.bbai-bulk-progress__log');
$log.append(logEntry);
$log.scrollTop($log[0].scrollHeight);
};
/**
* Add success log entry
*/
window.logBulkProgressSuccess = function(successMessage) {
var $modal = $('#bbai-bulk-progress-modal');
if (!$modal.length) return;
var timestamp = new Date().toLocaleTimeString();
var escapeHtml = window.bbaiEscapeHtml || function(t) { return t; };
var logEntry =
'<div class="bbai-bulk-progress__log-entry bbai-bulk-progress__log-entry--success">' +
'    <span class="bbai-bulk-progress__log-time">' + timestamp + '</span>' +
'    <span class="bbai-bulk-progress__log-icon">✓</span>' +
'    <span class="bbai-bulk-progress__log-text">' + escapeHtml(successMessage || 'Success') + '</span>' +
'</div>';
var $log = $modal.find('.bbai-bulk-progress__log');
$log.append(logEntry);
$log.scrollTop($log[0].scrollHeight);
};
/**
* Update bulk progress modal title
*/
window.updateBulkProgressTitle = function(title) {
var $modal = $('#bbai-bulk-progress-modal');
if (!$modal.length) return;
$modal.find('.bbai-bulk-progress__title').text(title);
};
/**
* Hide bulk progress bar
*/
window.hideBulkProgress = function() {
var $modal = $('#bbai-bulk-progress-modal');
if ($modal.length) {
$modal.removeClass('active');
$('body').css('overflow', '');
}
};
})(jQuery);
/* ============================================
* success-modal.js
* ============================================ */
/**
* Success Modal
* Displays success information after bulk operations complete
*
* @package BeepBeep_AI
* @since 5.0.0
*/
(function($) {
'use strict';
var escapeHtml = window.bbaiEscapeHtml || function(text) {
var div = document.createElement('div');
div.textContent = text;
return div.innerHTML;
};
/**
* Create and show success modal
*/
function createSuccessModal() {
var modalHtml =
'<div id="bbai-modal-success" class="bbai-modal-success" role="dialog" aria-modal="true" aria-labelledby="bbai-modal-success-title">' +
'    <div class="bbai-modal-success__overlay"></div>' +
'    <div class="bbai-modal-success__content">' +
'        <button type="button" class="bbai-modal-success__close" aria-label="' + escapeHtml('Close') + '">×</button>' +
'        <div class="bbai-modal-success__header">' +
'            <div class="bbai-modal-success__badge">' +
'                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">' +
'                    <path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>' +
'                </svg>' +
'            </div>' +
'            <h2 id="bbai-modal-success-title" class="bbai-modal-success__title">Alt Text Generated Successfully</h2>' +
'            <p class="bbai-modal-success__subtitle">Your images have been processed and are ready to review.</p>' +
'        </div>' +
'        <div class="bbai-modal-success__stats">' +
'            <div class="bbai-modal-success__stat-card">' +
'                <div class="bbai-modal-success__stat-number" data-stat="processed">0</div>' +
'                <div class="bbai-modal-success__stat-label">Images Processed</div>' +
'            </div>' +
'            <div class="bbai-modal-success__stat-card">' +
'                <div class="bbai-modal-success__stat-number" data-stat="time">0</div>' +
'                <div class="bbai-modal-success__stat-label">Time Saved</div>' +
'            </div>' +
'            <div class="bbai-modal-success__stat-card">' +
'                <div class="bbai-modal-success__stat-number" data-stat="confidence">0%</div>' +
'                <div class="bbai-modal-success__stat-label">AI Confidence</div>' +
'            </div>' +
'        </div>' +
'        <div class="bbai-modal-success__summary" data-summary-type="success">' +
'            <div class="bbai-modal-success__summary-icon">✓</div>' +
'            <div class="bbai-modal-success__summary-text">All images were processed successfully.</div>' +
'        </div>' +
'        <div class="bbai-modal-success__actions">' +
'            <a href="' + escapeHtml((typeof ajaxurl !== 'undefined' ? ajaxurl.replace('/admin-ajax.php', '/admin.php') : '/wp-admin/admin.php') + '?page=bbai&tab=library') + '" class="bbai-modal-success__btn bbai-modal-success__btn--primary">View ALT Library →</a>' +
'            <button type="button" class="bbai-modal-success__btn bbai-modal-success__btn--secondary" data-action="view-warnings" style="display: none;">View Warnings</button>' +
'        </div>' +
'    </div>' +
'</div>';
var $existing = $('#bbai-modal-success');
if ($existing.length) {
$existing.remove();
}
$('body').append(modalHtml);
var $modal = $('#bbai-modal-success');
$modal.find('.bbai-modal-success__close, .bbai-modal-success__overlay').on('click', function() {
hideSuccessModal();
});
$modal.find('[data-action="view-warnings"]').on('click', function() {
hideSuccessModal();
var libraryUrl = (typeof ajaxurl !== 'undefined' ? ajaxurl.replace('/admin-ajax.php', '/admin.php') : '/wp-admin/admin.php') + '?page=bbai&tab=library';
window.location.href = libraryUrl;
});
$(document).on('keydown.bbai-success-modal', function(e) {
if (e.keyCode === 27 && $modal.hasClass('active')) {
hideSuccessModal();
}
});
return $modal;
}
/**
* Show success modal with stats
*/
window.showSuccessModal = function(data) {
var $modal = $('#bbai-modal-success');
if (!$modal.length) {
$modal = createSuccessModal();
}
$modal.find('[data-stat="processed"]').text(data.processed || 0);
$modal.find('[data-stat="time"]').text(data.timeSaved || '0 hours');
$modal.find('[data-stat="confidence"]').text((data.confidence || 0) + '%');
var $summary = $modal.find('.bbai-modal-success__summary');
var $warningsBtn = $modal.find('[data-action="view-warnings"]');
if (data.failures > 0) {
$summary.attr('data-summary-type', 'warning');
$summary.find('.bbai-modal-success__summary-icon').text('⚠');
$summary.find('.bbai-modal-success__summary-text').text('Some images generated with warnings — review details below.');
$warningsBtn.show();
} else {
$summary.attr('data-summary-type', 'success');
$summary.find('.bbai-modal-success__summary-icon').text('✓');
$summary.find('.bbai-modal-success__summary-text').text('All images were processed successfully.');
$warningsBtn.hide();
}
$modal.addClass('active');
$('body').css('overflow', 'hidden');
setTimeout(function() {
$modal.find('.bbai-modal-success__close').focus();
}, 100);
};
/**
* Hide success modal
*/
window.hideSuccessModal = function() {
var $modal = $('#bbai-modal-success');
if ($modal.length) {
$modal.removeClass('active');
$('body').css('overflow', '');
$(document).off('keydown.bbai-success-modal');
}
};
})(jQuery);
/* ============================================
* inline-generate.js
* ============================================ */
/**
* Inline Generation
* Handles inline alt text generation for queued images
*
* @package BeepBeep_AI
* @since 5.0.0
*/
(function($) {
'use strict';
/**
* Begin inline generation after queue completes
*/
window.startInlineGeneration = function(idList, source) {
if (!idList || !idList.length || !window.bbaiHasBulkConfig) {
return;
}
var normalized = Array.from(new Set(idList.map(function(id) {
return parseInt(id, 10);
}).filter(function(id) {
return !isNaN(id) && id > 0;
})));
if (!normalized.length) {
return;
}
var $modal = $('#bbai-bulk-progress-modal');
if (!$modal.length) {
return;
}
$modal.data('startTime', Date.now());
$modal.data('total', normalized.length);
$modal.data('current', 0);
$modal.data('successes', 0);
$modal.data('failed', 0);
$modal.find('.bbai-bulk-progress__total').text(normalized.length);
$modal.find('.bbai-bulk-progress__current').text(0);
$modal.find('.bbai-bulk-progress__percentage').text('0%');
$modal.find('.bbai-bulk-progress__eta').text('Calculating...');
$modal.find('.bbai-bulk-progress__bar-fill').css('width', '0%');
var intro = 'Starting inline generation for ' + normalized.length + ' image' + (normalized.length !== 1 ? 's' : '') + '...';
updateBulkProgressTitle('Generating Alt Text…');
logBulkProgressSuccess(intro);
$modal.data('batchQueue', normalized.slice(0));
var inlineBatchSize = window.BBAI && window.BBAI.inlineBatchSize
? Math.max(1, parseInt(window.BBAI.inlineBatchSize, 10))
: 1;
processInlineGenerationQueue(normalized, inlineBatchSize);
};
/**
* Process images sequentially in batches and update modal progress
*/
function processInlineGenerationQueue(queue, batchSize) {
batchSize = batchSize || 1;
var $modal = $('#bbai-bulk-progress-modal');
if (!$modal.length) {
return;
}
var total = queue.length;
var processed = 0;
var successes = 0;
var failures = 0;
var active = 0;
function processNext() {
if (!queue.length && active === 0) {
finalizeInlineGeneration(successes, failures);
return;
}
if (active >= batchSize || !queue.length) {
return;
}
var id = queue.shift();
active++;
generateAltTextForId(id)
.then(function(result) {
successes++;
processed++;
var title = result && result.title ? result.title : ('Generated alt text for image #' + id);
updateBulkProgress(processed, total, title);
})
.catch(function(error) {
failures++;
processed++;
var message = 'Image #' + id + ': ' + (error && error.message ? error.message : 'Failed to generate alt text.');
logBulkProgressError(message);
updateBulkProgress(processed, total);
})
.finally(function() {
active--;
setTimeout(processNext, 250);
});
if (active < batchSize && queue.length) {
processNext();
}
}
processNext();
}
/**
* Finalize inline generation and show success modal
*/
function finalizeInlineGeneration(successes, failures) {
var $modal = $('#bbai-bulk-progress-modal');
var total = successes + failures;
var startTime = $modal.length ? $modal.data('startTime') : Date.now();
var elapsed = (Date.now() - startTime) / 1000;
var timeSavedMinutes = successes * 2;
var timeSavedHours = Math.round(timeSavedMinutes / 60);
var timeSavedText = timeSavedHours > 0 ? timeSavedHours + ' hour' + (timeSavedHours !== 1 ? 's' : '') : '< 1 hour';
var confidence = total > 0 ? Math.round((successes / total) * 100) : 100;
hideBulkProgress();
setTimeout(function() {
showSuccessModal({
processed: successes,
total: total,
failures: failures,
timeSaved: timeSavedText,
confidence: confidence
});
}, 300);
if (typeof refreshUsageStats === 'function') {
refreshUsageStats();
}
}
/**
* Generate alt text for a single image ID
*/
function generateAltTextForId(id) {
return new Promise(function(resolve, reject) {
var ajaxUrl = (window.bbai_ajax && (window.bbai_ajax.ajax_url || window.bbai_ajax.ajaxurl)) ||
(typeof ajaxurl !== 'undefined' ? ajaxurl : '/wp-admin/admin-ajax.php');
var nonceValue = (window.bbai_ajax && window.bbai_ajax.nonce) || '';
$.ajax({
url: ajaxUrl,
method: 'POST',
dataType: 'json',
data: {
action: 'beepbeepai_inline_generate',
attachment_ids: [id],
nonce: nonceValue
}
})
.done(function(response) {
try {
if (response && response.success) {
if (response.data && response.data.results && Array.isArray(response.data.results)) {
var first = response.data.results[0];
if (first && first.success) {
resolve({
id: id,
alt: first.alt_text || '',
title: first.title || ('Image #' + id)
});
return;
} else {
var errorMsg = 'Failed to generate alt text.';
if (first && first.message) {
errorMsg = first.message;
} else if (first && first.code) {
errorMsg = 'Generation failed: ' + first.code;
}
reject({ message: errorMsg, code: (first && first.code) ? first.code : 'generation_failed' });
return;
}
}
else if (response.data && response.data.alt_text) {
resolve({
id: id,
alt: response.data.alt_text || '',
title: 'Image #' + id
});
return;
}
else if (response.data && response.data.message) {
reject({ message: response.data.message });
return;
}
}
if (response && response.success === false) {
var errorMsg = 'Failed to generate alt text.';
if (response.data && response.data.message) {
errorMsg = response.data.message;
} else if (response.message) {
errorMsg = response.message;
}
reject({ message: errorMsg, code: (response.data && response.data.code) || response.code || 'api_error' });
return;
}
console.error('[AI Alt Text] Unexpected response structure:', response);
reject({ message: 'Unexpected response from server.' });
} catch (e) {
console.error('[AI Alt Text] Error parsing response:', e, response);
reject({ message: 'Error parsing server response: ' + (e.message || 'Unknown error') });
}
})
.fail(function(xhr) {
var message = 'Request failed';
var errorCode = null;
if (xhr && xhr.responseJSON) {
if (xhr.responseJSON.data && xhr.responseJSON.data.message) {
message = xhr.responseJSON.data.message;
} else if (xhr.responseJSON.message) {
message = xhr.responseJSON.message;
}
if (xhr.responseJSON.data && xhr.responseJSON.data.code) {
errorCode = xhr.responseJSON.data.code;
} else if (xhr.responseJSON.code) {
errorCode = xhr.responseJSON.code;
}
} else if (xhr && xhr.status === 0) {
message = 'Network error: Unable to connect to server.';
} else if (xhr && xhr.status === 404) {
message = 'AJAX endpoint not found.';
} else if (xhr && xhr.status === 500) {
message = 'Server error occurred.';
} else if (xhr && xhr.status) {
message = 'Request failed with status ' + xhr.status;
}
console.error('[AI Alt Text] Inline generate request failed:', {
status: xhr ? xhr.status : 'unknown',
message: message
});
reject({ message: message, code: errorCode });
});
});
}
})(jQuery);
/* ============================================
* bulk-operations.js
* ============================================ */
/**
* Bulk Operations
* Handles generate missing and regenerate all operations
*
* @package BeepBeep_AI
* @since 5.0.0
*/
(function($) {
'use strict';
var config = window.bbaiAdminConfig || {};
/**
* Check usage stats and determine if user can proceed
*/
function checkUsageBeforeOperation() {
var usageStats = (window.BBAI_DASH && window.BBAI_DASH.initialUsage) ||
(window.BBAI_DASH && window.BBAI_DASH.usage) ||
(window.BBAI && window.BBAI.usage) || null;
var remaining = usageStats && (usageStats.remaining !== undefined) ? parseInt(usageStats.remaining, 10) : null;
var plan = usageStats && usageStats.plan ? usageStats.plan.toLowerCase() : 'free';
var isPremium = plan === 'pro' || plan === 'agency';
var isOutOfCredits = remaining !== null && remaining !== undefined && remaining === 0;
return {
usageStats: usageStats,
remaining: remaining,
isPremium: isPremium,
isOutOfCredits: isOutOfCredits,
hasCredits: remaining !== null && remaining !== undefined && remaining > 0
};
}
/**
* Generate alt text for missing images
*/
window.handleGenerateMissing = function(e) {
e.preventDefault();
var $btn = $(this);
var originalText = $btn.text();
if ($btn.prop('disabled')) {
return false;
}
if (!window.bbaiHasBulkConfig) {
window.bbaiModal.error('Configuration error. Please refresh the page and try again.');
return false;
}
var usage = checkUsageBeforeOperation();
if (usage.hasCredits) {
continueWithGeneration();
return false;
}
if (!usage.usageStats) {
continueWithGeneration();
return false;
}
if (!usage.isPremium && usage.isOutOfCredits) {
window.bbaiHandleLimitReached({
message: 'Monthly limit reached. Upgrade to continue generating alt text.',
code: 'limit_reached',
usage: usage.usageStats
});
return false;
}
continueWithGeneration();
return false;
function continueWithGeneration() {
$btn.prop('disabled', true);
$btn.text('Loading...');
$.ajax({
url: config.restMissing || (config.restRoot + 'bbai/v1/list?scope=missing'),
method: 'GET',
headers: {
'X-WP-Nonce': config.nonce
},
data: {
limit: 500
}
})
.done(function(response) {
if (!response || !response.ids || response.ids.length === 0) {
window.bbaiModal.info('No images found that need alt text.');
$btn.prop('disabled', false);
$btn.text(originalText);
return;
}
var ids = response.ids || [];
var count = ids.length;
showBulkProgress('Preparing bulk run...', count, 0);
bbaiQueueImages(ids, 'bulk', function(success, queued, error, processedIds) {
$btn.prop('disabled', false);
$btn.text(originalText);
if (success && queued > 0) {
updateBulkProgressTitle('Successfully Queued!');
logBulkProgressSuccess('Successfully queued ' + queued + ' image' + (queued !== 1 ? 's' : '') + ' for processing');
startInlineGeneration(processedIds || ids, 'bulk');
} else if (success && queued === 0) {
updateBulkProgressTitle('Already Queued');
logBulkProgressSuccess('All images are already in queue or processing');
startInlineGeneration(processedIds || ids, 'bulk');
} else {
handleBulkError(error, ids, count, $btn, originalText, 'bulk');
}
});
})
.fail(function(xhr, status, error) {
console.error('[AI Alt Text] Failed to get missing images:', error, xhr);
$btn.prop('disabled', false);
$btn.text(originalText);
logBulkProgressError('Failed to load images. Please try again.');
});
}
};
/**
* Regenerate alt text for all images
*/
window.handleRegenerateAll = function(e) {
e.preventDefault();
if (!confirm('This will regenerate alt text for ALL images, replacing existing alt text. Are you sure?')) {
return false;
}
var $btn = $(this);
var originalText = $btn.text();
if ($btn.prop('disabled')) {
return false;
}
if (!window.bbaiHasBulkConfig) {
window.bbaiModal.error('Configuration error. Please refresh the page and try again.');
return false;
}
var usage = checkUsageBeforeOperation();
if (!usage.isPremium && usage.isOutOfCredits) {
window.bbaiHandleLimitReached({
message: 'Monthly limit reached. Upgrade to continue regenerating alt text.',
code: 'limit_reached',
usage: usage.usageStats
});
return false;
}
$btn.prop('disabled', true);
$btn.text('Loading...');
$.ajax({
url: config.restAll || (config.restRoot + 'bbai/v1/list?scope=all'),
method: 'GET',
headers: {
'X-WP-Nonce': config.nonce
},
data: {
limit: 500
}
})
.done(function(response) {
if (!response || !response.ids || response.ids.length === 0) {
window.bbaiModal.info('No images found.');
$btn.prop('disabled', false);
$btn.text(originalText);
return;
}
var ids = response.ids || [];
var count = ids.length;
showBulkProgress('Preparing bulk regeneration...', count, 0);
bbaiQueueImages(ids, 'bulk-regenerate', function(success, queued, error, processedIds) {
$btn.prop('disabled', false);
$btn.text(originalText);
if (success && queued > 0) {
updateBulkProgressTitle('Successfully Queued!');
logBulkProgressSuccess('Successfully queued ' + queued + ' image' + (queued !== 1 ? 's' : '') + ' for regeneration');
startInlineGeneration(processedIds || ids, 'bulk-regenerate');
} else if (success && queued === 0) {
updateBulkProgressTitle('Already Queued');
logBulkProgressSuccess('All images are already in queue or processing');
startInlineGeneration(processedIds || ids, 'bulk-regenerate');
} else {
handleBulkError(error, ids, count, $btn, originalText, 'bulk-regenerate');
}
});
})
.fail(function(xhr, status, error) {
console.error('[AI Alt Text] Failed to get all images:', error, xhr);
$btn.prop('disabled', false);
$btn.text(originalText);
logBulkProgressError('Failed to load images. Please try again.');
});
};
/**
* Handle bulk operation errors
*/
function handleBulkError(error, ids, count, $btn, originalText, source) {
if (error && error.code === 'limit_reached') {
hideBulkProgress();
window.bbaiHandleLimitReached(error);
return;
}
if (error && error.code === 'insufficient_credits' && error.remaining !== null && error.remaining === 0) {
hideBulkProgress();
window.bbaiHandleLimitReached(error);
return;
}
if (error && error.message) {
logBulkProgressError(error.message);
} else {
logBulkProgressError('Failed to queue images. Please try again.');
}
if (error && error.code) {
console.error('[AI Alt Text] Error:', error.code, error.message || 'Unknown error');
}
if (error && error.code === 'insufficient_credits' && error.remaining !== null && error.remaining > 0) {
hideBulkProgress();
var remainingCount = error.remaining;
var errorMsg = error.message || 'You only have ' + remainingCount + ' generations remaining.';
var generateWithRemaining = confirm(
errorMsg + '\n\n' +
'Would you like to generate ' + remainingCount + ' image' + (remainingCount !== 1 ? 's' : '') +
' now using your remaining ' + remainingCount + ' credit' + (remainingCount !== 1 ? 's' : '') + '?\n\n' +
'(Click "OK" to generate now, or "Cancel" to upgrade)'
);
if (generateWithRemaining) {
var limitedIds = ids.slice(0, remainingCount);
$btn.prop('disabled', true);
$btn.text('Loading...');
showBulkProgress('Queueing ' + remainingCount + ' image' + (remainingCount !== 1 ? 's' : '') + '...', remainingCount, 0);
bbaiQueueImages(limitedIds, source, function(success, queued, queueError, processedLimited) {
$btn.prop('disabled', false);
$btn.text(originalText);
if (success && queued > 0) {
updateBulkProgressTitle('Successfully Queued!');
logBulkProgressSuccess('Queued ' + queued + ' image' + (queued !== 1 ? 's' : '') + ' using remaining credits');
startInlineGeneration(processedLimited || limitedIds, source);
} else {
var msg = 'Failed to queue images.';
if (queueError && queueError.message) {
msg = queueError.message;
}
logBulkProgressError(msg);
}
});
} else {
var confirmUpgrade = confirm(
'Would you like to upgrade to get more credits and generate all ' + count +
' image' + (count !== 1 ? 's' : '') + '?'
);
if (confirmUpgrade) {
if (typeof alttextaiShowModal === 'function') {
alttextaiShowModal();
} else {
var upgradeBtn = document.querySelector('[data-action="show-upgrade-modal"]');
if (upgradeBtn) {
upgradeBtn.click();
}
}
}
}
}
}
})(jQuery);
/* ============================================
* single-regenerate.js
* ============================================ */
/**
* Single Regenerate
* Handles single image regeneration with preview modal
*
* @package BeepBeep_AI
* @since 5.0.0
*/
(function($) {
'use strict';
/**
* Regenerate alt text for a single image - shows modal with preview
*/
window.handleRegenerateSingle = function(e) {
e.preventDefault();
console.log('[AI Alt Text] Regenerate button clicked');
var $btn = $(this);
var attachmentId = $btn.data('attachment-id');
console.log('[AI Alt Text] Attachment ID:', attachmentId);
if (!attachmentId || $btn.prop('disabled')) {
console.warn('[AI Alt Text] Cannot regenerate - missing ID or button disabled');
return false;
}
var originalText = $btn.text();
$btn.prop('disabled', true).addClass('regenerating');
$btn.text('Processing...');
var $row = $btn.closest('tr');
var imageTitle = $row.find('.bbai-table__cell--title').text().trim() || 'Image';
var imageSrc = $row.find('img').attr('src') || '';
var $altCell = $row.find('.bbai-library-cell--alt-text');
var originalCellContent = $altCell.html();
$altCell.data('original-content', originalCellContent);
$altCell.html(
'<div class="bbai-alt-text-content">' +
'<div class="bbai-skeleton bbai-skeleton--text" style="width: 90%; margin-bottom: 8px;"></div>' +
'<div class="bbai-skeleton bbai-skeleton--text-sm" style="width: 60%;"></div>' +
'</div>'
);
showRegenerateModal(attachmentId, imageTitle, imageSrc, $btn, originalText);
};
/**
* Show regenerate modal and start generation
*/
function showRegenerateModal(attachmentId, imageTitle, imageSrc, $btn, originalBtnText) {
var $modal = $('#bbai-regenerate-modal');
if (!$modal.length) {
$modal = createRegenerateModal();
}
$modal.find('.bbai-regenerate-modal__image-title').text(imageTitle);
$modal.find('.bbai-regenerate-modal__thumbnail').attr('src', imageSrc);
$modal.find('.bbai-regenerate-modal__loading').addClass('active');
$modal.find('.bbai-regenerate-modal__result').removeClass('active');
$modal.find('.bbai-regenerate-modal__error').removeClass('active');
$modal.find('.bbai-regenerate-modal__btn--accept').prop('disabled', true);
$modal.addClass('active');
$('body').css('overflow', 'hidden');
var ajaxUrl = (window.bbai_ajax && window.bbai_ajax.ajaxurl) ||
(window.BBAI && window.BBAI.restRoot ? window.BBAI.restRoot.replace(/\/$/, '') + '/admin-ajax.php' : null) ||
(typeof ajaxurl !== 'undefined' ? ajaxurl : '/wp-admin/admin-ajax.php');
var nonceValue = (window.bbai_ajax && window.bbai_ajax.nonce) ||
(window.BBAI && window.BBAI.nonce) ||
'';
$.ajax({
url: ajaxUrl,
method: 'POST',
data: {
action: 'beepbeepai_regenerate_single',
attachment_id: attachmentId,
nonce: nonceValue
}
})
.done(function(response) {
$modal.find('.bbai-regenerate-modal__loading').removeClass('active');
if (response && response.success) {
var newAltText = (response.data && response.data.altText) || (response.data && response.data.alt_text) || '';
if (newAltText) {
$modal.find('.bbai-regenerate-modal__alt-text').text(newAltText);
$modal.find('.bbai-regenerate-modal__result').addClass('active');
$modal.find('.bbai-regenerate-modal__btn--accept')
.prop('disabled', false)
.off('click')
.on('click', function() {
acceptRegeneratedAltText(attachmentId, newAltText, $btn, originalBtnText, $modal);
});
} else {
showModalError($modal, 'No alt text was generated. Please try again.');
reenableButton($btn, originalBtnText);
}
} else {
var errorData = response && response.data ? response.data : {};
if (errorData.code === 'limit_reached') {
closeRegenerateModal($modal);
reenableButton($btn, originalBtnText);
window.bbaiHandleLimitReached(errorData);
} else if (errorData.code === 'auth_required' || (errorData.message && errorData.message.toLowerCase().includes('authentication required'))) {
closeRegenerateModal($modal);
reenableButton($btn, originalBtnText);
if (typeof window.authModal !== 'undefined' && window.authModal && typeof window.authModal.show === 'function') {
window.authModal.show();
window.authModal.showLoginForm();
} else if (typeof showAuthModal === 'function') {
showAuthModal('login');
} else if (typeof showAuthLogin === 'function') {
showAuthLogin();
} else {
showModalError($modal, 'Please log in to regenerate alt text.');
}
} else {
var message = errorData.message || 'Failed to regenerate alt text';
showModalError($modal, message);
reenableButton($btn, originalBtnText);
}
}
})
.fail(function(xhr, status, error) {
console.error('[AI Alt Text] Failed to regenerate:', error, xhr);
$modal.find('.bbai-regenerate-modal__loading').removeClass('active');
var errorData = xhr.responseJSON && xhr.responseJSON.data ? xhr.responseJSON.data : {};
if (errorData.code === 'limit_reached') {
closeRegenerateModal($modal);
reenableButton($btn, originalBtnText);
window.bbaiHandleLimitReached(errorData);
} else if (errorData.code === 'auth_required') {
closeRegenerateModal($modal);
reenableButton($btn, originalBtnText);
if (typeof showAuthModal === 'function') {
showAuthModal('login');
}
} else {
var message = errorData.message || 'Failed to regenerate alt text. Please try again.';
showModalError($modal, message);
reenableButton($btn, originalBtnText);
}
});
$modal.find('.bbai-regenerate-modal__btn--cancel')
.off('click')
.on('click', function() {
closeRegenerateModal($modal);
reenableButton($btn, originalBtnText);
});
}
/**
* Create the regenerate modal HTML
*/
function createRegenerateModal() {
var modalHtml =
'<div id="bbai-regenerate-modal" class="bbai-regenerate-modal">' +
'    <div class="bbai-regenerate-modal__content">' +
'        <div class="bbai-regenerate-modal__header">' +
'            <h2 class="bbai-regenerate-modal__title">Regenerate Alt Text</h2>' +
'            <p class="bbai-regenerate-modal__subtitle">Review the new alt text before applying</p>' +
'        </div>' +
'        <div class="bbai-regenerate-modal__body">' +
'            <div class="bbai-regenerate-modal__image-preview">' +
'                <img src="" alt="" class="bbai-regenerate-modal__thumbnail">' +
'                <div class="bbai-regenerate-modal__image-info">' +
'                    <p class="bbai-regenerate-modal__image-title"></p>' +
'                </div>' +
'            </div>' +
'            <div class="bbai-regenerate-modal__error"></div>' +
'            <div class="bbai-regenerate-modal__loading">' +
'                <div class="bbai-regenerate-modal__spinner"></div>' +
'                <p class="bbai-regenerate-modal__loading-text">Generating new alt text...</p>' +
'            </div>' +
'            <div class="bbai-regenerate-modal__result">' +
'                <p class="bbai-regenerate-modal__alt-text-label">New Alt Text:</p>' +
'                <p class="bbai-regenerate-modal__alt-text"></p>' +
'            </div>' +
'        </div>' +
'        <div class="bbai-regenerate-modal__footer">' +
'            <button type="button" class="bbai-regenerate-modal__btn bbai-regenerate-modal__btn--cancel">Cancel</button>' +
'            <button type="button" class="bbai-regenerate-modal__btn bbai-regenerate-modal__btn--accept" disabled>Accept & Apply</button>' +
'        </div>' +
'    </div>' +
'</div>';
$('body').append(modalHtml);
return $('#bbai-regenerate-modal');
}
/**
* Show error in modal
*/
function showModalError($modal, message) {
$modal.find('.bbai-regenerate-modal__error').text(message).addClass('active');
}
/**
* Close regenerate modal
*/
function closeRegenerateModal($modal) {
$modal.removeClass('active');
$('body').css('overflow', '');
}
/**
* Re-enable the regenerate button and restore cell content if cancelled
*/
function reenableButton($btn, originalText) {
$btn.prop('disabled', false).removeClass('regenerating');
$btn.text(originalText);
var $row = $btn.closest('tr');
var $altCell = $row.find('.bbai-library-cell--alt-text');
var originalContent = $altCell.data('original-content');
if (originalContent && $altCell.find('.bbai-skeleton').length) {
$altCell.html(originalContent);
$altCell.removeData('original-content');
}
}
/**
* Calculate SEO quality score for alt text
*/
function calculateSeoQuality(text) {
if (!text || text.trim() === '') {
return { score: 0, grade: 'F', badge: 'missing' };
}
var score = 100;
var textLength = text.length;
if (textLength > 125) {
score -= 25;
}
var lowerText = text.toLowerCase().trim();
var redundantPrefixes = ['image of', 'picture of', 'photo of', 'photograph of', 'graphic of', 'illustration of'];
for (var i = 0; i < redundantPrefixes.length; i++) {
if (lowerText.indexOf(redundantPrefixes[i]) === 0) {
score -= 20;
break;
}
}
if (/^IMG[-_]\d+/i.test(text) || /^DSC[-_]\d+/i.test(text) || /\.(jpg|jpeg|png|gif|webp)$/i.test(text)) {
score -= 30;
}
var words = text.trim().split(/\s+/);
if (words.length < 3) {
score -= 15;
}
score = Math.max(0, score);
var grade, badge;
if (score >= 90) { grade = 'A'; badge = 'excellent'; }
else if (score >= 75) { grade = 'B'; badge = 'good'; }
else if (score >= 60) { grade = 'C'; badge = 'fair'; }
else if (score >= 40) { grade = 'D'; badge = 'poor'; }
else { grade = 'F'; badge = 'needs-work'; }
return { score: score, grade: grade, badge: badge };
}
/**
* Accept regenerated alt text and update the UI
*/
function acceptRegeneratedAltText(attachmentId, newAltText, $btn, originalBtnText, $modal) {
var $row = $btn.closest('tr');
if (newAltText) {
var $altCell = $row.find('.bbai-library-cell--alt-text');
if ($altCell.length) {
var safeAlt = $('<div>').text(newAltText).html();
var truncated = newAltText.length > 80 ? newAltText.substring(0, 77) + '…' : newAltText;
var safeTruncated = $('<div>').text(truncated).html();
var charCount = newAltText.length;
var isOptimal = charCount <= 125;
var counterClass = isOptimal ? 'bbai-char-counter--optimal' : 'bbai-char-counter--warning';
var counterTooltip = isOptimal ? 'Optimal length for Google Images SEO' : 'Consider shortening to 125 chars or less';
var seoQuality = calculateSeoQuality(newAltText);
var seoBadgeHtml = '';
if (seoQuality.badge !== 'missing') {
seoBadgeHtml = '<span class="bbai-meta-separator">○</span>' +
'<span class="bbai-seo-badge bbai-seo-badge--' + seoQuality.badge + '" data-bbai-tooltip="SEO Score: ' + seoQuality.grade + ' (' + seoQuality.score + '/100)" data-bbai-tooltip-position="top">SEO: ' + seoQuality.grade + '</span>' +
'<span class="bbai-meta-separator">○</span>';
}
var cellHtml =
'<div class="bbai-alt-text-content">' +
'<div class="bbai-alt-text-preview" title="' + safeAlt + '">' + safeTruncated + '</div>' +
'<div class="bbai-alt-text-meta">' +
'<span class="' + counterClass + '" data-bbai-tooltip="' + counterTooltip + '" data-bbai-tooltip-position="top">' + charCount + '/125</span>' +
seoBadgeHtml +
'</div>' +
'</div>';
$altCell.html(cellHtml);
var $statusCell = $row.find('.bbai-library-cell--status span');
if ($statusCell.length) {
$statusCell
.removeClass()
.addClass('bbai-status-badge bbai-status-badge--regenerated')
.text('Regenerated');
}
$row.attr('data-status', 'regenerated');
}
}
closeRegenerateModal($modal);
reenableButton($btn, originalBtnText);
if (typeof showNotification === 'function') {
showNotification('Alt text updated successfully!', 'success');
}
if (typeof refreshUsageStats === 'function') {
refreshUsageStats();
}
}
})(jQuery);
/* ============================================
* license.js
* ============================================ */
/**
* License Management
* Handles license activation and deactivation
*
* @package BeepBeep_AI
* @since 5.0.0
*/
(function($) {
'use strict';
/**
* Handle license activation form submission
*/
window.handleLicenseActivation = function(e) {
e.preventDefault();
var $form = $('#license-activation-form');
var $input = $('#license-key-input');
var $button = $('#activate-license-btn');
var $status = $('#license-activation-status');
var nonce = $('#license-nonce').val();
var licenseKey = $input.val().trim();
if (!licenseKey) {
showLicenseStatus('error', 'Please enter a license key');
return;
}
$button.prop('disabled', true).text('Activating...');
$input.prop('disabled', true);
$.ajax({
url: ajaxurl,
type: 'POST',
data: {
action: 'beepbeepai_activate_license',
nonce: nonce,
license_key: licenseKey
},
success: function(response) {
if (response.success) {
showLicenseStatus('success', response.data.message || 'License activated successfully!');
setTimeout(function() {
window.location.reload();
}, 1000);
} else {
showLicenseStatus('error', response.data.message || 'Failed to activate license');
$button.prop('disabled', false).text('Activate License');
$input.prop('disabled', false);
}
},
error: function(xhr, status, error) {
showLicenseStatus('error', 'Network error: ' + error);
$button.prop('disabled', false).text('Activate License');
$input.prop('disabled', false);
}
});
};
/**
* Handle license deactivation
*/
window.handleLicenseDeactivation = function(e) {
e.preventDefault();
if (!confirm('Are you sure you want to deactivate this license? You will need to reactivate it to continue using the shared quota.')) {
return;
}
var $button = $(this);
var nonce = $('#license-nonce').val();
$button.prop('disabled', true).text('Deactivating...');
$.ajax({
url: ajaxurl,
type: 'POST',
data: {
action: 'beepbeepai_deactivate_license',
nonce: nonce
},
success: function(response) {
if (response.success) {
window.bbaiModal.show({
type: 'success',
title: 'Success',
message: response.data.message || 'License deactivated successfully',
onClose: function() {
window.location.reload();
}
});
} else {
window.bbaiModal.error('Error: ' + (response.data.message || 'Failed to deactivate license'));
$button.prop('disabled', false).text('Deactivate License');
}
},
error: function(xhr, status, error) {
window.bbaiModal.error('Network error: ' + error);
$button.prop('disabled', false).text('Deactivate License');
}
});
};
/**
* Show status message in license activation form
*/
function showLicenseStatus(type, message) {
var $status = $('#license-activation-status');
var iconHtml = '';
var bgColor = '';
var textColor = '';
if (type === 'success') {
iconHtml = '<svg width="20" height="20" viewBox="0 0 20 20" fill="none" style="vertical-align: middle; margin-right: 8px;"><circle cx="10" cy="10" r="9" stroke="currentColor" stroke-width="2" fill="none"/><path d="M6 10L9 13L14 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
bgColor = '#d1fae5';
textColor = '#065f46';
} else {
iconHtml = '<svg width="20" height="20" viewBox="0 0 20 20" fill="none" style="vertical-align: middle; margin-right: 8px;"><circle cx="10" cy="10" r="9" stroke="currentColor" stroke-width="2" fill="none"/><path d="M10 6v4M10 14h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>';
bgColor = '#fee2e2';
textColor = '#991b1b';
}
$status.html(
'<div style="padding: 12px; background: ' + bgColor + '; color: ' + textColor + '; border-radius: 4px; font-size: 14px;">' +
iconHtml + message +
'</div>'
).show();
}
})(jQuery);
/* ============================================
* init.js
* ============================================ */
/**
* Admin Initialization
* Main entry point for admin functionality
*
* @package BeepBeep_AI
* @since 5.0.0
*/
(function($) {
'use strict';
$(document).ready(function() {
if (window.BBAI_DEBUG) {
console.log('[AI Alt Text] Admin JavaScript loaded');
console.log('[AI Alt Text] Config:', window.bbaiAdminConfig);
}
$(document).on('click', '[data-action="generate-missing"]', handleGenerateMissing);
$(document).on('click', '[data-action="regenerate-all"]', handleRegenerateAll);
$(document).on('click', '[data-action="regenerate-single"]', function(e) {
handleRegenerateSingle.call(this, e);
});
$('#license-activation-form').on('submit', handleLicenseActivation);
$(document).on('click', '[data-action="deactivate-license"]', handleLicenseDeactivation);
});
})(jQuery);