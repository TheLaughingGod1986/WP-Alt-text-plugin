/**
 * Pricing Modal Bridge (minified-compatible copy)
 */
!function(window){"use strict";const pricingModalState={isOpen:!1,currentPlan:null,isLoading:!1,onPlanSelect:null},existingOpenPricingModal="function"==typeof window.openPricingModal?window.openPricingModal:null;async function fetchUserPlan(){try{pricingModalState.isLoading=!0;const wpApiUrl=window.bbai_ajax?.ajaxurl||"/wp-json/bbai/v1/user/plan",apiUrl=window.bbai_ajax?.api_url||"/api/user/plan";let response;try{const token=window.bbai_ajax?.jwt_token||localStorage.getItem("bbai_jwt_token");response=await fetch(apiUrl,{method:"GET",headers:{"Content-Type":"application/json",...(token&&{Authorization:`Bearer ${token}`})},credentials:"include"})}catch(e){const nonce=window.bbai_ajax?.nonce||"";response=await fetch(wpApiUrl,{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":nonce},credentials:"include"})}if(response&&response.ok){const data=await response.json();pricingModalState.currentPlan=data.plan||data.data?.plan||data.data?.data?.plan||"free"}else pricingModalState.currentPlan="free"}catch(error){console.warn("[AltText AI] Could not fetch user plan:",error),pricingModalState.currentPlan="free"}finally{pricingModalState.isLoading=!1}}function handlePlanSelect(planId){pricingModalState.onPlanSelect&&"function"==typeof pricingModalState.onPlanSelect?pricingModalState.onPlanSelect(planId):console.log("[AltText AI] Plan selected:",planId),closePricingModal()}function closePricingModal(){pricingModalState.isOpen=!1,"function"==typeof window.closePricingModal&&window.closePricingModal()}function openPricingModal(variant="enterprise"){if(pricingModalState.isOpen=!0,fetchUserPlan(),existingOpenPricingModal&&existingOpenPricingModal!==openPricingModal)return void existingOpenPricingModal(variant);if("function"==typeof window.initPricingModal||"undefined"!=typeof React&&"undefined"!=typeof ReactDOM){if(document.getElementById("bbai-pricing-modal-root")||"function"==typeof window.initPricingModal&&window.initPricingModal("bbai-pricing-modal-root",handlePlanSelect),"function"==typeof window.openPricingModal&&window.openPricingModal!==openPricingModal)return void window.openPricingModal(variant)}if("undefined"!=typeof bbaiApp&&"function"==typeof bbaiApp.showModal)return void bbaiApp.showModal();if("function"==typeof alttextaiShowModal)return void alttextaiShowModal();console.warn("[AltText AI] React not available. Please include React and ReactDOM for the pricing modal."),window.bbaiModal&&"function"==typeof window.bbaiModal.error&&window.bbaiModal.error("Pricing modal requires React. Please include React and ReactDOM libraries.")}function setPlanSelectCallback(callback){pricingModalState.onPlanSelect=callback}function getCurrentPlan(){return pricingModalState.currentPlan}"function"!=typeof window.openPricingModal&&(window.openPricingModal=openPricingModal),window.closePricingModal=closePricingModal,window.setPricingModalCallback=setPlanSelectCallback,window.getCurrentPlan=getCurrentPlan,"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll('[data-action="show-upgrade-modal"]').forEach(trigger=>{trigger.addEventListener("click",e=>(e.preventDefault(),e.stopPropagation(),openPricingModal("enterprise"),!1))}),"undefined"!=typeof jQuery&&(jQuery(document).off("click",'[data-action="show-upgrade-modal"]'),jQuery(document).on("click",'[data-action="show-upgrade-modal"]',e=>(e.preventDefault(),e.stopPropagation(),openPricingModal("enterprise"),!1)))}):(document.querySelectorAll('[data-action="show-upgrade-modal"]').forEach(trigger=>{trigger.addEventListener("click",e=>(e.preventDefault(),e.stopPropagation(),openPricingModal("enterprise"),!1))}),"undefined"!=typeof jQuery&&(jQuery(document).off("click",'[data-action="show-upgrade-modal"]'),jQuery(document).on("click",'[data-action="show-upgrade-modal"]',e=>(e.preventDefault(),e.stopPropagation(),openPricingModal("enterprise"),!1))))),"undefined"!=typeof module&&module.exports&&(module.exports={openPricingModal:openPricingModal,closePricingModal:closePricingModal,setPlanSelectCallback:setPlanSelectCallback,getCurrentPlan:getCurrentPlan})}(window);




