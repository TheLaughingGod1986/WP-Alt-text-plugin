!function(e){"use strict";const n={isOpen:!1,currentPlan:null,isLoading:!1,onPlanSelect:null};function t(e){n.onPlanSelect&&"function"==typeof n.onPlanSelect?n.onPlanSelect(e):console.log("[AltText AI] Plan selected:",e),o()}function a(a="enterprise"){n.isOpen=!0,async function(){try{n.isLoading=!0;const t=e.bbai_ajax?.ajaxurl||"/wp-json/bbai/v1/user/plan",a=e.bbai_ajax?.api_url||"/api/user/plan";let o;try{const n=e.bbai_ajax?.jwt_token||localStorage.getItem("bbai_jwt_token");o=await fetch(a,{method:"GET",headers:{"Content-Type":"application/json",...n&&{Authorization:`Bearer ${n}`}},credentials:"include"})}catch(n){const a=e.bbai_ajax?.nonce||"";o=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":a},credentials:"include"})}if(o&&o.ok){const e=await o.json();n.currentPlan=e.plan||e.data?.plan||e.data?.data?.plan||"free"}else n.currentPlan="free"}catch(e){console.warn("[AltText AI] Could not fetch user plan:",e),n.currentPlan="free"}finally{n.isLoading=!1}}(),"function"!=typeof e.initPricingModal&&("undefined"==typeof React||"undefined"==typeof ReactDOM)||(document.getElementById("bbai-pricing-modal-root")||"function"==typeof e.initPricingModal&&e.initPricingModal("bbai-pricing-modal-root",t),"function"!=typeof e.openPricingModal)?(console.warn("[AltText AI] React not available. Please include React and ReactDOM for the pricing modal."),alert("Pricing modal requires React. Please include React and ReactDOM libraries.")):e.openPricingModal(a)}function o(){n.isOpen=!1,"function"==typeof e.closePricingModal&&e.closePricingModal()}function i(e){n.onPlanSelect=e}function c(){return n.currentPlan}if(e.openPricingModal=a,e.closePricingModal=o,e.setPricingModalCallback=i,e.getCurrentPlan=c,"undefined"!=typeof document){const e=function(){document.querySelectorAll('[data-action="show-upgrade-modal"]').forEach(function(e){e.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),a("enterprise"),!1})}),"undefined"!=typeof jQuery&&(jQuery(document).off("click",'[data-action="show-upgrade-modal"]'),jQuery(document).on("click",'[data-action="show-upgrade-modal"]',function(e){return e.preventDefault(),e.stopPropagation(),a("enterprise"),!1}))};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}"undefined"!=typeof module&&module.exports&&(module.exports={openPricingModal:a,closePricingModal:o,setPlanSelectCallback:i,getCurrentPlan:c})}(window);